<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>index (gitlab.index)</title><link rel="stylesheet" href="../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ gitlab</nav><header class="odoc-preamble"><h1 id="top"><a href="#top" class="anchor"></a>OCaml GitLab</h1><p><code>GitLab</code> is an OCaml library that allows interaction with the <a href="http://gitlab.com">GitLab</a> software hosting platform.</p><p><i>NOTE: This library is still under development and parts of the API might not be stable.</i></p></header><nav class="odoc-toc"><ul><li><a href="#installing">Installing</a><ul><li><a href="#install-source">Source code</a></li><li><a href="#install-opam">Using opam</a></li></ul></li><li><a href="#fundamentals">Fundamentals</a></li><li><a href="#full">GitLab API</a></li><li><a href="#resources">Resources</a></li><li><a href="#bugs">Bugs</a></li></ul></nav><div class="odoc-content"><h2 id="installing"><a href="#installing" class="anchor"></a>Installing</h2><h3 id="install-source"><a href="#install-source" class="anchor"></a>Source code</h3><p>The source code for <code>GitLab</code> can be found at <a href="http://github.com/tmcgilchrist/ocaml-gitlab">tmcgilchrist/ocaml-gitlab</a>, it uses the <a href="https://dune.readthedocs.io/">dune</a> build system and <a href="https://opam.ocaml.org">opam</a> for package management.</p><h3 id="install-opam"><a href="#install-opam" class="anchor"></a>Using opam</h3><p>You can install <code>GitLab</code> using <code>opam</code> by folllowing the instructions below:</p><pre>opam install gitlab</pre><h2 id="fundamentals"><a href="#fundamentals" class="anchor"></a>Fundamentals</h2><p><code>GitLab</code> allows OCaml programmers to programatically interact with the GitLab REST API. It uses two key libraries in OCaml, <a href="https://ocsigen.org/lwt/latest/manual/manual">LWT</a> for concurrent programming using Promises and <a href="https://github.com/mirage/ocaml-cohttp">CoHTTP</a> to make HTTP requests. Familiarity with at least LWT is useful to understand using <code>GitLab</code>, in particular the Monadic interface.</p><p>To make a simple API request to find GitLab users by name:</p><pre><code>let open Gitlab in
let open Monad in
User.by_name ~name () &gt;&gt;~ fun users -&gt;
List.iter (fun user -&gt;
  printf &quot;%s\n&quot; user.Gitlab_t.user_short_username) users;
  return () </code></pre><p>We open both the <code>Gitlab</code> and <code>Monad</code> modules to bring everything into scope, then build up a Monadic computation with <code>User.by_name ~name</code> and print out the users returned. <a href="Gitlab_s/module-type-Gitlab/Monad/index.html"><code>Gitlab_s.Gitlab.Monad</code></a> contains the expected <code>bind</code>, <code>map</code> and <code>return</code> functions along with infix operations like <code>&gt;&gt;~</code> and <code>&gt;&gt;=</code>, and binding operators like <code>let*</code> and <code>and*</code>.</p><p>This expression then needs to be run in Lwt as:</p><pre><code>let user_cmd name =
  let open Gitlab in
  let open Monad in
  User.by_name ~name () &gt;&gt;~ fun users -&gt;
  List.iter (fun user -&gt;
    printf &quot;%s\n&quot; user.Gitlab_t.user_short_username) users;
    return () 
in
Lwt_main.run @@ Gitlab.Monad.run (user_cmd &quot;tmcgilchrist&quot;)</code></pre><p>The GitLab API functions come in two flavours:</p><ol><li>Simple requests that receive a single response ending with <code>'a Response.t Monad.t</code></li><li>Streaming paginated request that return many responses that would not fit into a single response. <code>'a Stream.t</code></li></ol><p>For simple request use <code>bind</code> and the helper <code>&gt;&gt;~</code> from <a href="Gitlab_s/module-type-Gitlab/Monad/index.html"><code>Gitlab_s.Gitlab.Monad</code></a>. For streaming responses the <a href="Gitlab_s/module-type-Gitlab/Stream/index.html"><code>Gitlab_s.Gitlab.Stream</code></a> provides an abstraction to GitLab's paginated endpoints. For a more detailed example using the API look at the <a href="https://github.com/tmcgilchrist/ocaml-gitlab/blob/master/cli/lab.ml">lab</a> command line tool.</p><p>See <a href="Gitlab_s/module-type-Gitlab/index.html"><code>Gitlab_s.Gitlab</code></a> for the generalised GitLab API.</p><p>The GitLab API types are in <a href="Gitlab_t/index.html"><code>Gitlab_t</code></a>, users of the library would typically use these types over those in <a href="Gitlab_j/index.html"><code>Gitlab_j</code></a>.</p><p>The GitLab API types again and serialisation code for the API are in <a href="Gitlab_j/index.html"><code>Gitlab_j</code></a>, it contains duplicate type definitions from <a href="Gitlab_t/index.html"><code>Gitlab_t</code></a> and is useful if access to serialisation functions is required. Typically used for debugging or formatted output as JSON.</p><p><a href="Gitlab_core/index.html"><code>Gitlab_core</code></a> provides the portable Functor to the GitLab API. Users of the library will not typically need this unless they want to provide another Lwt runtime eg Mirage or Javascript.</p><h2 id="full"><a href="#full" class="anchor"></a>GitLab API</h2><p>Full GitLab API:</p><ul class="modules"><li><a href="Gitlab_s/index.html"><code>Gitlab_s</code></a> </li><li><a href="Gitlab_core/index.html"><code>Gitlab_core</code></a> <span class="synopsis">Portable functor to the GitLab API.</span></li><li><a href="Gitlab_t/index.html"><code>Gitlab_t</code></a> </li><li><a href="Gitlab_j/index.html"><code>Gitlab_j</code></a> </li></ul><h2 id="resources"><a href="#resources" class="anchor"></a>Resources</h2><p>The REST API for Gitlab is available at <a href="https://docs.gitlab.com/ee/api/api_resources.html">https://docs.gitlab.com/ee/api/api_resources.html</a>.</p><h2 id="bugs"><a href="#bugs" class="anchor"></a>Bugs</h2><p>Please file any issues encountered at <a href="https://github.com/tmcgilchrist/ocaml-gitlab/issues">https://github.com/tmcgilchrist/ocaml-gitlab/issues</a></p></div></body></html>